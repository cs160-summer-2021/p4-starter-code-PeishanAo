{% load static %}

<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>P3 Coloring</title>

    <script type="text/javascript" src="{% static 'coloring/vendors/jquery/jquery-3.3.1.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'coloring/vendors/paper/paper-full.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'draw/style.css' %}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Otomanopee+One&family=Yomogi&display=swap" rel="stylesheet">

    <script type="text/javascript" canvas="canvas">
        window.onload = function() {
            var colorWell;
            var defaultColor = "#000000";
            var curr = document.getElementById('current-color');

            function startup() {
                colorWell = document.querySelector("#colorWell");
                colorWell.value = defaultColor;
                colorWell.addEventListener("input", getColor, false);
                colorWell.addEventListener("change", getColor, false);
                colorWell.select();
            }
            startup();

            //var curr = "#000000";
            function getColor(event) {
                cp.history.push(event.target.value);
                //curr = event.target.value;
                curr.style.backgroundColor = cp.history[cp.history.length - 1];
            }

            document.getElementById("add-button").onclick = function() {
                addToPalette()
            };

            function addToPalette() {
                /*cp.options.push(cp.history[cp.history.length - 1]);
                var $swatch = $("<div>").css("background-color", cp.history[cp.history.length - 1])
                					   .addClass("swatch");
                cp.$container.append($swatch);*/

                var $swatch = $("<div>").css("background-color", cp.history[cp.history.length - 1])
                    .addClass("swatch");
                $swatch.click(function() {
                    // add color to the color palette history
                    cp.history.push($(this).css("background-color"));
                    curr.style.backgroundColor = cp.history[cp.history.length - 1];
                });
                cp.options.push(cp.history[cp.history.length - 1]);
                cp.$container.append($swatch);
            }

            //

            var canvas = document.getElementById('myCanvas');

            // coloring page
            var mandala = {
                item: null,
                lastClicked: null,
                filePath: '/static/coloring/images/mandala-freepik.svg'
            };

            // color palette
            var cp = {
                history: ["#000000"], // black selected by default
                options: [],
                $container: $('#color-palette')
            }

            function myCustomInteraction() {
                var tool = new paper.Tool();

                tool.onMouseDown = function(event) {
                    var hit = mandala.item.hitTest(event.point, {
                        tolerance: 10,
                        fill: true
                    });
                    if (hit) {
                        // Color pallette keeps track of the full history of colors, though we
                        // only color in with the most-recent color.
                        hit.item.fillColor = cp.history[cp.history.length - 1];
                    }
                }
            }

            // create a color palette with the given colors
            function createColorPalette(colors) {

                // create a swatch for each color
                for (var i = colors.length - 1; i >= 0; i--) {
                    var $swatch = $("<div>").css("background-color", colors[i])
                        .addClass("swatch");
                    $swatch.click(function() {
                        // add color to the color palette history
                        cp.history.push($(this).css("background-color"));
                        curr.style.backgroundColor = cp.history[cp.history.length - 1];
                    });
                    cp.$container.append($swatch);
                }
            }

            // loads a set of colors from a json to create a color palette
            function getColorsCreatePalette() {
                cp.$container.html(" ");
                $.getJSON('/static/coloring/vendors/material/material-colors.json', function(colors) {
                    var keys = Object.keys(colors);
                    for (var i = keys.length - 1; i >= 0; i--) {
                        cp.options.push(colors[keys[i]][400]);
                    }
                    createColorPalette(cp.options);
                });
            }



            function init(custom) {
                paper.setup(canvas);
                getColorsCreatePalette();

                paper.project.importSVG(mandala.filePath, function(item) {
                    mandala.item = item._children["design-freepik"];
                    paper.project.insertLayer(0, mandala.item);
                    paper.project.layers[0].fitBounds(paper.view.bounds);

                    if (custom) {
                        //newInteraction();
                        myCustomInteraction();
                    } else {
                        myGradientInteraction();
                    }

                });
            }

            // Set up the mandala interactivity.
            init(true);
        }
    </script>
</head>

<body>
    <br><br>
    <div id="title-container">
        <h1 id="title">Welcome to Food Share!</h1>
    </div>
    <br><br>
    <h2 style="text-align: center; font-family: Lucida Sans; padding-top: 10px; color:#606c38; text-shadow: 2px 2px #606c38;">
        SEARCH FOR FOOD INFO
        <h2>
            <div class="background">

                <!-- action="" TODO -->
                <form id="input-box" action="/action_page.php" style="text-align: center;">
                    <label for="searchNumber" style="font-family: Lucida Sans; color:#606c38; font-size: 35px">Enter the
						food number:</label>
                    <br><br>
                    <textarea id="searchNumber" name="searchNumber" rows="1" cols="40" style="background-color: #f1faee;"></textarea>
                    <br><br>
                    <input type="submit" value="search" style="font-family: Lucida Sans; background-color: #f1faee; border-radius: 10px; height: 50px; font-size: 35px; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">
                </form>
            </div>
            <footer>
                <a href="/draw/home">
                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
						<path
							d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z" />
					</svg>
                </a>
                <a href="/draw/search1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
						<path
							d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
					</svg> </a>
                <a href="/draw/search2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-question-circle" viewBox="0 0 16 16">
						<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
						<path
							d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z" />
					</svg> </a>
                </a>
                <a href="/draw/info">
                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-info-square" viewBox="0 0 16 16">
						<path
							d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
						<path
							d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
					</svg> </a>
            </footer>
            <script type="text/javascript">
                $("#colorWell").change(function(event) {
                    console.log($(this).val());
                    $("#color_front").css('background-color', $(this).val());
                });

                $("#color_front").click(function(event) {
                    $("#colorWell").click();
                });

                function jumpToNext() {
                    location.href = 'http://localhost:8000/draw/info';
                }
            </script>


</body>

</html>
</div>

</div>

<script type="text/javascript">
    $("#colorWell").change(function(event) {
        console.log($(this).val());
        $("#color_front").css('background-color', $(this).val());
    });

    $("#color_front").click(function(event) {
        $("#colorWell").click();
    });

    function jumpToNext() {
        location.href = 'http://localhost:8000/draw/info';
    }
</script>


</body>

</html>