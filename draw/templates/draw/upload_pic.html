{% load static %}

<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Upload Picture</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Otomanopee+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'draw/vendors/bootstrap/css/bootstrap.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'draw/style.css' %}" />

</head>

<body>
    <br><br><br><br>
    <br><br>
    <h1>Welcome to Food Share!</h1>
    <br>
    <h2>Upload picture of the food you're bringing!</h2>
    <h2>Choose from camera roll:</h2>
    <div>
        <img src="https://scontent-iad3-1.xx.fbcdn.net/v/t31.18172-8/27797787_549860015372465_6852515564461745853_o.jpg?_nc_cat=108&ccb=1-3&_nc_sid=84a396&_nc_ohc=W-ygTLJaFGMAX-wyFJR&tn=R2S7m-omV_t6lQPB&_nc_ht=scontent-iad3-1.xx&oh=67027d3c2b14af8a63a811599ea6a54e&oe=611F560E"
            style="margin-left:10%" />
    </div>
    <button onclick="location.href='/draw/home'" type="button" id="back">Back</button>
    <button onclick="location.href='/draw/upload_description'" type="button" id="next">Next</button>
    <footer>
        <a href="/draw/home">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
						<path
							d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z" />
					</svg>
        </a>
        <a href="/draw/search1">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
						<path
							d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
					</svg> </a>
        <a href="/draw/search2">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-question-circle" viewBox="0 0 16 16">
						<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
						<path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
					  </svg> </a>
        <a href="/draw/info">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-info-square" viewBox="0 0 16 16">
						<path
							d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
						<path
							d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
					</svg> </a>

    </footer>
</body>

<script>
    var uid = Date.now() % 10000;
    var smallSockets = new Map();
    var tag;
    var src;

    // getting the URL (you may want to use for Exercise 3)
    var url = window.location.href;

    var socket = new WebSocket(
        'ws://' + window.location.host + '/ws/draw');
    addEventListener("mousedown", mouseDown);
    function mouseDown() {
            //var element = document.elementFromPoint(event.clientX, event.clientX);
            tag = event.target.tagName;
            console.log("element tag: " + tag);
            // only send pic in this page
            if(tag == 'IMG'){
                src = event.target.src;
                socket.send("{\"src\" : " + "\""+src+"\"" + ", \"tag\" : " + "\""+tag+"\"" + ", \"page\" : " + "\"upload_pic\"" + "}");
            }
            /*else{
                var text = event.target.innerText;
                console.log("element text: " + text);
                socket.send("{\"text\" : " + "\""+text+"\"" + ", \"tag\" : " + "\""+tag+"\"" + "}");
            }*/
    }

    if (url.indexOf("large") > -1) {
        socket.onmessage = function(receivedMessage) {
            var received = JSON.parse(receivedMessage.data);
            console.log("Received: " + JSON.stringify(received));
            console.log("element" + received.element);
            document.body.appendChild(received.element); 
        }
    }

    socket.onclose = function(e) {
        console.error('Chat socket closed unexpectedly');
    };
</script>

</html>